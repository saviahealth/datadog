{"title":"Overall Platform health","description":"","widgets":[{"id":2404552583628504,"definition":{"title":"","type":"manage_status","display_format":"countsAndList","color_preference":"text","hide_zero_counts":true,"show_status":true,"last_triggered_format":"relative","query":"","sort":"status,asc","count":50,"start":0,"summary_type":"monitors","show_priority":false,"show_last_triggered":false},"layout":{"x":0,"y":0,"width":2,"height":11}},{"id":5577614553921749,"definition":{"title":"Replication Slot Status","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query2","data_source":"metrics","query":"min:saviadb.replication_slot.active{slot_type:logical} by {client}","aggregator":"last"},{"name":"query1","data_source":"metrics","query":"max:saviadb.replication_slot.backlog_size{slot_type:logical} by {client}","aggregator":"last"}],"sort":{"count":500,"order_by":[{"type":"formula","index":1,"order":"desc"}]},"formulas":[{"conditional_formats":[{"comparator":">","value":0,"palette":"white_on_green"},{"comparator":"<","value":1,"palette":"white_on_red"}],"alias":"active","formula":"query2"},{"cell_display_mode":"trend","conditional_formats":[{"comparator":">","value":25000000000,"palette":"red"},{"comparator":">","value":10000000000,"palette":"orange"},{"comparator":"<=","value":10000000000,"palette":"green"}],"number_format":{"unit":{"type":"canonical_unit","unit_name":"byte"}},"alias":"backlog","formula":"query1"}]}],"has_search_bar":"never"},"layout":{"x":2,"y":0,"width":2,"height":2}},{"id":2464192712502813,"definition":{"title":"Database Used Storage (%)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"metrics","query":"max:azure.dbforpostgresql_flexibleservers.storage_percent{*} by {client}","aggregator":"avg"}],"response_format":"scalar","sort":{"order_by":[{"type":"group","name":"client","order":"asc"}],"count":500},"formulas":[{"conditional_formats":[{"comparator":">","value":50,"palette":"white_on_yellow"},{"comparator":">","value":75,"palette":"white_on_red"},{"comparator":"<=","value":50,"palette":"white_on_green"}],"cell_display_mode":"number","alias":"% Used","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":4,"y":0,"width":2,"height":2}},{"id":2837245236249100,"definition":{"title":"QIE Errors","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"data_source":"metrics","name":"query1","query":"sum:qie.channel.errors{*} by {client}","aggregator":"last"}],"response_format":"scalar","sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"conditional_formats":[{"comparator":">","value":20,"palette":"white_on_red"},{"comparator":">=","value":1,"palette":"white_on_yellow"},{"comparator":">=","value":0,"palette":"white_on_green"}],"cell_display_mode":"number","alias":"Error Count","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":6,"y":0,"width":2,"height":2}},{"id":3425658051143259,"definition":{"title":"QIE Backlog","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"data_source":"metrics","name":"query1","query":"sum:qie.channel.inbound{*} by {client}","aggregator":"last"},{"data_source":"metrics","name":"query2","query":"sum:qie.channel.outbound{*} by {client}","aggregator":"last"}],"response_format":"scalar","sort":{"order_by":[{"type":"formula","index":0,"order":"desc"}],"count":500},"formulas":[{"alias":"Backlog","formula":"query1 + query2","conditional_formats":[{"comparator":"<","value":500,"palette":"green"},{"comparator":"<","value":1200,"palette":"orange"},{"comparator":">=","value":1200,"palette":"red"}],"cell_display_mode":"trend"}]}],"has_search_bar":"auto"},"layout":{"x":8,"y":0,"width":2,"height":2}},{"id":1478450394211188,"definition":{"title":"Dead Letter Topic Backlogs","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"metrics","query":"sum:pulsar.subscription_back_log{subscription:*-DLT OR subscription:*-dlt} by {client}","aggregator":"last"}],"response_format":"scalar","sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","conditional_formats":[{"comparator":">","value":0,"palette":"white_on_yellow"}],"formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":10,"y":0,"width":2,"height":2}},{"id":5366466457329083,"definition":{"title":"Maximum Pulsar Subscription Backlog","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"max:pulsar.subscription_back_log{(namespace:clinical-apps/* OR namespace:inbound/clinical-events) AND NOT subscription:__* AND NOT subscription:*Reader* AND NOT subscription:*reader* AND NOT subscription:*-DLT AND NOT subscription:*-dlt AND NOT subscription:*_compaction*} by {client}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear"},"markers":[],"custom_links":[{"label":"/dashboard/vh4-zy3-kcf/pipeline-message-processing?tpl_var_pulsar_namespace={{namespace}}","link":"/dashboard/vh4-zy3-kcf/pipeline-message-processing?tpl_var_pulsar_namespace={{namespace.value}}"}]},"layout":{"x":2,"y":2,"width":5,"height":3}},{"id":4150729105816010,"definition":{"title":"Maximum Kafka Consumer Group Lag","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"max:kafka_consumergroup_lag_sum{!consumergroup:cli*} by {client}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"markers":[{"label":"y = 100","value":"y = 100","display_type":"error dashed"}]},"layout":{"x":7,"y":2,"width":5,"height":3}},{"id":6065655452075872,"definition":{"title":"Pulsar Local Storage","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 - query2"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:pulsar.storage_size{!namespace:compliance/*} by {pulsar_cluster}"},{"name":"query2","data_source":"metrics","query":"sum:pulsar.storage_offloaded_size{!namespace:compliance/*} by {pulsar_cluster}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":2,"y":5,"width":5,"height":3}},{"id":5458102764854210,"definition":{"title":"Pulsar Local Audit Storage","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1 - query2"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:pulsar.storage_size{namespace:compliance/*} by {pulsar_cluster}"},{"name":"query2","data_source":"metrics","query":"sum:pulsar.storage_offloaded_size{namespace:compliance/*} by {pulsar_cluster}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":7,"y":5,"width":5,"height":3}},{"id":8868888990764298,"definition":{"title":"30-Day Log Usage ($/day)","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{"type":"live","unit":"week","value":4},"type":"timeseries","requests":[{"formulas":[{"alias":"ingestion ($)","number_format":{"unit":{"type":"canonical_unit","unit_name":"dollar"}},"formula":"query1 / 1024 / 1024 / 1024 * 0.1 * 4"},{"alias":"indexing ($)","number_format":{"unit":{"type":"canonical_unit","unit_name":"dollar"}},"formula":"query2 / 1000000 * 1.2 * 4"},{"alias":"metrics ($)","formula":"cutoff_min((query3 - 4000) / 100 * 5 / 30, 0)"}],"queries":[{"data_source":"metrics","name":"query1","query":"sum:datadog.estimated_usage.logs.ingested_bytes{*}.rollup(sum, 21600)"},{"data_source":"metrics","name":"query2","query":"sum:datadog.estimated_usage.logs.ingested_events{datadog_is_excluded:false}.as_count().rollup(sum, 21600)"},{"data_source":"metrics","name":"query3","query":"sum:datadog.estimated_usage.metrics.custom{*}.rollup(max, 21600)"}],"response_format":"timeseries","style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":2,"y":8,"width":10,"height":3}}],"template_variables":[],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed","tags":["team:platform-infrastructure-team"]}